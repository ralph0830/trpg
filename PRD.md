제품 요구사항 정의서 (PRD)
문서명: AI 기반 D&D 5e 웹 TRPG 게임
작성자: AI Assistant
버전: 2.0
작성일: 2025.09.02
업데이트: 백엔드 구현 완료 (2025.09.02)

1. 개요
1.1. 제품 비전
인공지능의 무한한 창의력을 활용하여, 별도의 인간 GM 없이도 누구나 자유롭고 역동적인 스토리 기반의 TRPG(Tabletop Role-Playing Game) 경험을 할 수 있는 웹 기반 플랫폼을 구축한다. 플레이어는 예측 불가능한 AI가 창조하는 세계 속에서 친구들과 함께 모험하며, 매번 새로운 서사를 만들어낼 수 있다.

1.2. 제품 설명
본 제품은 D&D 5판 규칙을 기반으로 한 4명의 플레이어가 참여하는 웹 기반 TRPG 게임입니다. Gemini AI가 게임 마스터 역할을 수행하며, 실시간으로 스토리를 생성하고 NPC를 조작합니다. 플레이어는 웹 브라우저를 통해 캐릭터를 조작하고, 실시간 채팅으로 소통하며, d20 시스템 기반의 전투와 기술 판정을 경험합니다.

1.3. 목표 고객
TRPG 경험이 있지만, GM 역할을 할 사람이 부족한 플레이어

새롭고 독특한 게임 경험을 찾는 게이머

친구들과 가볍게 즐길 수 있는 온라인 협동 게임을 원하는 사용자

TRPG 초보자 및 AI 기술에 관심이 많은 사용자

2. 목표 및 목적
2.1. 비즈니스 목표
AI를 활용한 게임의 기술적 가능성 입증

높은 사용자 참여율 및 세션 지속 시간 달성

반복 플레이가 가능한 높은 콘텐츠 생산성 확보

향후 유료 모델 및 기능 확장의 기반 마련

2.2. 사용자 목표
인간 GM 없이도 TRPG의 핵심 재미를 경험한다.

매번 플레이할 때마다 예측 불가능하고 새로운 이야기를 만난다.

실시간 채팅을 통해 친구들과 협력하여 게임을 진행한다.

로그인하지 않은 파티원은 AI가 대신하여 게임이 중단 없이 진행되는 것을 보장받는다.

3. 주요 기능 및 요구사항
3.1. 핵심 게임 플레이 루프
요구사항: AI Agent (GM)와의 실시간 텍스트 채팅을 통한 상호작용

요구사항: 플레이어의 행동에 따라 AI가 게임 내 사건(NPC 대화, 퀘스트 부여, 몬스터 조우 등)을 동적으로 생성 및 진행

3.2. 멀티플레이어 시스템
요구사항: 4인 파티 기반의 네트워크 플레이 지원

요구사항: 파티원 간의 실시간 채팅 기능 (WebSockets 기반)

요구사항: 플레이어가 로그인하지 않을 경우, 해당 캐릭터를 AI가 자동으로 대체하여 게임 진행

3.3. 게임 세계 및 자산
요구사항: 맵은 AI가 실시간으로 생성하는 타일 기반 구조

요구사항: 맵 데이터(2D 배열)를 백엔드에서 관리하고, 프론트엔드에서 렌더링

요구사항: AI가 생성하는 마을, 던전, NPC 등은 데이터로 관리

요구사항: AI의 지시에 따라 맵의 타일이 동적으로 변경 가능

3.4. 캐릭터 및 인벤토리
요구사항: 각 플레이어 캐릭터의 기본 능력치(HP, MP 등) 관리

요구사항: 플레이어가 획득한 아이템을 보관할 수 있는 인벤토리 시스템

요구사항: 아이템 및 능력치 데이터는 백엔드 데이터베이스에 저장

요구사항: 플레이어가 아이템을 사용하면 서버에서 능력치 변경 등 효과 처리

3.5. 기술적 요구사항 ✅ 구현 완료

**백엔드 (완료)**
- Node.js + Express.js: REST API 서버 (포트 3002)
- Socket.IO: 실시간 WebSocket 통신 (게임 세션, 채팅, 캐릭터 이동)
- PostgreSQL: 게임 데이터 저장 (Docker 컨테이너)
- 완전한 DB 스키마: 7개 테이블 (sessions, characters, inventory, maps, events, npcs)

**프론트엔드 (기본 구조)**
- React 19 + Vite: 컴포넌트 기반 UI
- 3-패널 레이아웃: Map, Status+Inventory, Chat
- Socket.IO 클라이언트: 실시간 통신 준비

**AI Agent (예정)**  
- Gemini API: AI 게임 마스터
- D&D 5e 규칙 엔진: d20 시스템, 능력치, 전투
- n8n 워크플로우: 복잡한 게임 로직 자동화

**개발 환경**
- Docker Compose: PostgreSQL 데이터베이스
- Nodemon: 백엔드 자동 재시작  
- Vite: 프론트엔드 개발서버

4. 구현 현황 및 다음 단계

4.1. ✅ 완료된 기능
**백엔드 인프라**
- PostgreSQL 데이터베이스 및 완전한 스키마
- REST API (게임 세션, 캐릭터 관리)  
- Socket.IO 실시간 통신 (세션 참가, 채팅, 이동)
- 게임 이벤트 로깅 시스템

**데이터베이스 모델**
- 게임 세션 관리 (4인 파티, 상태 추적)
- 캐릭터 시스템 (HP, MP, 능력치, 위치)
- 인벤토리 및 아이템 관리
- 2D 타일 맵 시스템
- NPC/몬스터 데이터

4.2. 🔄 다음 우선순위 (MVP)
**Phase 1: Frontend 연동**
- Socket.IO 클라이언트 구현
- 실시간 채팅 및 게임 상태 동기화
- 캐릭터 생성 및 세션 참가 UI

**Phase 2: D&D 5e 게임 로직**
- d20 주사위 시스템 구현  
- 기본 능력치 및 기술 판정
- 단순화된 전투 시스템 (공격/방어)

**Phase 3: AI 게임 마스터**
- Gemini API 연동 및 프롬프트 엔지니어링
- 스토리 생성 및 NPC 대화 시스템
- 게임 이벤트 반응 및 판정 지원

4.3. 🚫 범위 외 (v2.0 이후)
- 고도화된 스킬 트리 및 레벨링
- 음성 채팅/인식 기능
- 3D 그래픽 및 애니메이션  
- 아이템 제작/거래 시스템
- 다중 캠페인 지원

5. 성공 지표
재방문율: 출시 후 7일 이내에 다시 접속하는 사용자의 비율

평균 세션 지속 시간: 게임에 접속하여 플레이하는 평균 시간

사용자 만족도: 플레이어 간/AI와의 상호작용에 대한 긍정적 반응

기술적 안정성: AI API 호출 성공률, 서버 다운타임 최소화

6. 기술 스택 및 의존성

**현재 구현된 기술**
- Backend: Node.js 22 + Express.js 5 + Socket.IO 4.8
- Database: PostgreSQL 14 (Alpine Docker)
- Frontend: React 19 + Vite 7 + ESLint 9
- Development: Docker Compose + Nodemon

**API 및 외부 서비스**  
- Gemini API: AI 게임 마스터 (API 키 설정 완료)
- n8n: 워크플로우 자동화 (webhook URL 설정 완료)

**가정 및 제약사항**
- D&D 5e 규칙의 단순화된 구현 (완전한 규칙서 대체 아님)
- 플레이어는 기본적인 TRPG 개념을 이해
- AI 응답의 일관성은 프롬프트 엔지니어링에 의존
- 최대 4명 동시 플레이어 지원

**운영 환경**
- 개발: Local Docker + Node.js
- 포트: Backend 3002, Frontend 5173, Database 5433
- 실시간 통신: WebSocket (Socket.IO)